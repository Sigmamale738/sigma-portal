<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sigma Portal - eBook Dashboard</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
    body { background: linear-gradient(145deg,#0a1f2d,#183b55); color: #fff; min-height: 100vh; overflow-x: hidden; }
    header { text-align: center; padding: 25px; background: rgba(255,255,255,0.1); backdrop-filter: blur(8px); border-bottom: 1px solid rgba(255,255,255,0.2); }
    header h1 { font-size: 1.9em; }
    header span { color: #3fa9f5; }
    .tabs { display: flex; justify-content: center; gap: 10px; padding: 10px; flex-wrap: wrap; }
    .tab-btn { background: rgba(255,255,255,0.15); border: none; color: #fff; padding: 8px 16px; border-radius: 6px; cursor: pointer; transition: 0.3s; }
    .tab-btn.active, .tab-btn:hover { background: #3fa9f5; }
    .tab-content { display: none; padding: 20px; animation: fadeIn 0.4s ease; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
    .upload-box { max-width: 400px; margin: 40px auto; background: rgba(255,255,255,0.08); padding: 25px; border-radius: 12px; text-align: center; box-shadow: 0 0 12px rgba(0,0,0,0.4); }
    input[type="file"] { margin: 10px 0; }
    button.upload-btn { background: #3fa9f5; border: none; padding: 8px 14px; border-radius: 6px; color: #fff; cursor: pointer; }
    .progress-bar { height: 8px; background: rgba(255,255,255,0.3); border-radius: 4px; overflow: hidden; margin-top: 10px; }
    .progress-bar div { height: 100%; width: 0%; background: #3fa9f5; transition: width 0.3s; }
    footer { text-align: center; padding: 20px; font-size: 0.9em; opacity: 0.8; }
</style>
</head>
<body>
<header>
    <h1>ðŸ“š <span>Sigma Portal</span> Dashboard</h1>
    <p>Community eBook Sharing Platform</p>
</header>

<div class="tabs">
    <button class="tab-btn active" onclick="showTab('upload')">Upload eBook</button>
    <button class="tab-btn" onclick="showTab('library')">Public Library</button>
    <button class="tab-btn" onclick="showTab('profile')">My Profile</button>
</div>

<!-- Upload Tab -->
<div id="upload" class="tab-content active">
    <div class="upload-box">
        <h3>Upload eBook</h3>
        <input type="file" id="fileInput">
        <button class="upload-btn" onclick="uploadFile()">Upload</button>
        <div class="progress-bar"><div id="progress"></div></div>
        <p id="statusText"></p>
    </div>
</div>

<!-- Library Tab -->
<div id="library" class="tab-content">
    <h3 style="text-align:center;">ðŸ“– Public Library</h3>
    <ul id="fileList" style="list-style:none;padding:10px;text-align:center;"></ul>
</div>

<!-- Profile Tab -->
<div id="profile" class="tab-content">
    <h3 style="text-align:center;">ðŸ‘¤ My Profile</h3>
    <p style="text-align:center;">Logged in as: <strong>Sigma User</strong></p>
    <p style="text-align:center;">Uploads will be shown soon.</p>
</div>

<footer>
    Â© 2025 Sigma Portal | Powered by Firebase
</footer>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyC79GvrDeN9XkiMga9XHHHqmUbPemHKpjY",
    authDomain: "sigmaportal-8d595.firebaseapp.com",
    projectId: "sigmaportal-8d595",
    storageBucket: "sigmaportal-8d595.firebasestorage.app",
    messagingSenderId: "250400389869",
    appId: "1:250400389869:web:a57865e79bd9523775aae4"
  };
  firebase.initializeApp(firebaseConfig);
  const storage = firebase.storage();
  const db = firebase.firestore();

  async function uploadFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return alert("Please choose a file first!");
    const storageRef = storage.ref('ebooks/' + file.name);
    const uploadTask = storageRef.put(file);

    document.getElementById('statusText').textContent = 'Uploading...';
    uploadTask.on('state_changed',
      (snapshot) => {
        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
        document.getElementById('progress').style.width = progress + '%';
      },
      (error) => {
        alert('Upload failed: ' + error.message);
      },
      async () => {
        const url = await uploadTask.snapshot.ref.getDownloadURL();
        await db.collection('ebooks').add({ name: file.name, url: url, timestamp: new Date() });
        document.getElementById('statusText').textContent = 'âœ… Upload complete!';
        loadFiles();
      }
    );
  }

  async function loadFiles() {
    const list = document.getElementById('fileList');
    list.innerHTML = '';
    const snapshot = await db.collection('ebooks').orderBy('timestamp', 'desc').get();
    snapshot.forEach(doc => {
      const data = doc.data();
      const li = document.createElement('li');
      li.innerHTML = `
        <div style="background:rgba(255,255,255,0.1);margin:10px;padding:10px;border-radius:8px;">
          <strong>${data.name}</strong><br>
          <a href="${data.url}" target="_blank" style="color:#3fa9f5;">Download</a>
        </div>`;
      list.appendChild(li);
    });
  }

  function showTab(tabId) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    const clickedButton = [...document.querySelectorAll('.tab-btn')]
      .find(btn => btn.getAttribute('onclick')?.includes(tabId));
    if (clickedButton) clickedButton.classList.add('active');
    if (tabId === 'library') loadFiles();
  }

  document.addEventListener('DOMContentLoaded', () => {
    loadFiles();
  });
</script>
</body>
</html>

